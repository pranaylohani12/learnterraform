resource "google_cloud_scheduler_job" "check_expired_projects_job" {
  name             = "${local.base_name}-check-expired-projects-job"
  description      = "Delete the expired projects in the experimental folder Unilever Experimental"
  schedule         = "0 0 * * *"
  attempt_deadline = "320s"

  retry_config {
    retry_count = 1
  }

  http_target {
    http_method = "POST"
    uri         = "https://${var.region}-${var.project}.cloudfunctions.net/checkexpiredprojects"
    body        = base64encode("{}")

    oidc_token {
      service_account_email = var.cf_service_account
    }
  }
}
